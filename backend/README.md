# FrankenJet backend

## Описание

Backend FrankenJet - это REST API, разработанный для энциклопедии истории авиации. Он предоставляет доступ к данным о статьях, воздушных судах, конструкторах и других сущностях проекта. Backend разработан с использованием асинхронного фреймворка FastAPI и PostgreSQL для хранения данных.

## Технологии

### Основные

* **Python:** _3.12_
* **Фреймворк:** Асинхронный _FastAPI_ для создания REST API.
* **База данных:** _PostgreSQL 17.x_
* **ORM:** _SQLAlchemy 2_ для работы с базой данных, используется для определения моделей данных и выполнения запросов.
* **Асинхронный драйвер PostgreSQL:** _AsyncPG_ для эффективной работы с базой данных в асинхронном режиме.
* **Миграции:** _Alembic_ для управления изменениями схемы базы данных.
* **Аутентификация и авторизация:**
  * Используется _JWT_ (JSON Web Tokens) для аутентификации и авторизации пользователей.
  * Поддержка _access/refresh_ токенов.
* **Работа с облачным хранилищем:** _AIOBoto3_ - асинхронная библиотека для взаимодействия с S3-совместимым хранилищем.
* **HTTP-клиент:** _AIOHTTP_ для выполнения HTTP-запросов.
* **Конфигурация:** _Pydantic Settings_ для загрузки настроек из переменных окружения в основном приложении и `Environs` для загрузки настроек из переменных окружения в скриптах инициализации приложения при запуске через `docker-compose`.
* **Безопасность:** _bcrypt_ для хеширования паролей.

### Инструменты разработки

* **Линтер:** _Ruff_ для автоматической проверки стиля кода и поиска ошибок.
* **Статический анализатор типов:** _MyPy_ для статического анализа типов данных, позволяет выявлять потенциальные ошибки типизации на этапе разработки.

### Архитектура и Паттерны

Для обеспечения гибкости и масштабируемости в архитектуре backend используются следующие паттерны:

* **Репозиторий (Repository):** используется для абстрагирования логики доступа к данным, предоставляет интерфейс для выполнения операций CRUD над сущностями базы данных, скрывая детали реализации, связанные с SQLAlchemy и AsyncPG.
* **Сервисный слой (Service Layer):** бизнес-логика приложения вынесена в сервисный слой, принимает запросы от API-эндпоинтов, выполняет необходимые операции и возвращает результаты.
* **Контекстные менеджеры (Context Managers):** обеспечивают автоматическое управление ресурсами (соединениями, сессиями), а также обработку ошибок и исключений. Реализованы следующие менеджеры:
  * **DBManager** — управление сессиями базы данных, открытие/закрытие, откат транзакций.
  * **S3Manager** — управление подключением к S3-совместимому хранилищу, загрузка/выгрузка/удаление файлов.
  * **RMQManager** — публикация и подписка на сообщения в RabbitMQ с поддержкой повторных попыток, автоматического переподключения.

## Roadmap

* Добавить контекстный менеджер AIOHTTP.
* Добавить админку.
* Добавить аутентификацию через VK ID, Yandex ID, Telegram.
* Добавить тесты.
* Добавить GitLab CI/CD и GitHub Actions.
* Добавить Prometheus, Grafana, Grafana loki.
